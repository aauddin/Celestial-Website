<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Helios Nouveau Orrery</title>
  <style>
    :root{
      --bg: #000;
      --text: #fff;

      /* Theme */
      --gold: rgba(255, 215, 0, 0.85);
      --gold-soft: rgba(255, 215, 0, 0.18);
      --gold-faint: rgba(255, 215, 0, 0.12);

      --sage: rgba(140, 255, 205, 0.18);
      --sage-strong: rgba(140, 255, 205, 0.30);
      --blush: rgba(255, 210, 185, 0.16);
      --sky: rgba(185, 210, 255, 0.14);

      --panel: rgba(17,17,17,0.86);
      --panel-border: rgba(255,215,0,0.22);
      --panel-border-strong: rgba(255,215,0,0.38);
    }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background: var(--bg);
      color: var(--text);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      overflow: hidden;
    }

    #wrapper {
      position: fixed;
      inset: 0;
      display: grid;
      place-items: center;
      background:
        radial-gradient(circle at center, #141414 0%, #060606 45%, #000 75%),
        radial-gradient(circle at 15% 20%, rgba(140,255,205,0.06) 0%, transparent 35%),
        radial-gradient(circle at 85% 25%, rgba(255,210,185,0.05) 0%, transparent 35%),
        radial-gradient(circle at 20% 85%, rgba(185,210,255,0.05) 0%, transparent 40%);
    }

    /* NEW: Panel wrapper for border + veil + content */
    #frameCard{
      position: relative;
      width: min(92vmin, 860px);
      /* gives breathing room so the floral border doesn't collide with header/canvas */
      padding: 22px;
      border-radius: 26px;
    }

    /* Content sits above panel overlays */
    #content {
      position: relative;
      z-index: 5;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      width: 100%;
    }

    #header {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      padding: 10px 12px;
      background: linear-gradient(180deg, rgba(0,0,0,0.55), rgba(0,0,0,0.25));
      border: 1px solid var(--panel-border);
      border-radius: 14px;
      box-shadow:
        0 0 22px rgba(255,215,0,0.10),
        inset 0 0 24px rgba(255,215,0,0.05);
      backdrop-filter: blur(2px);
    }

    h1 {
      margin: 0;
      font-weight: 500;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      font-size: 13px;
      text-align: center;
      opacity: 0.95;
    }

    #subtitle {
      font-size: 11px;
      opacity: 0.72;
      text-align: center;
      margin-top: -2px;
    }

    #controls {
      width: 100%;
      display: flex;
      flex-wrap: wrap;
      gap: 8px 10px;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      opacity: 0.9;
    }

    #controls label {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 8px;
      border: 1px solid rgba(255,215,0,0.18);
      border-radius: 10px;
      background: rgba(0,0,0,0.35);
    }

    #controls input[type="date"],
    #controls select {
      background: rgba(15,15,15,0.9);
      border: 1px solid rgba(255,215,0,0.18);
      color: #fff;
      padding: 4px 6px;
      border-radius: 8px;
      font-size: 11px;
      outline: none;
    }

    #controls button {
      background: rgba(15,15,15,0.75);
      border: 1px solid rgba(255,215,0,0.26);
      color: #fff;
      padding: 6px 9px;
      border-radius: 10px;
      font-size: 11px;
      cursor: pointer;
      transition: transform 0.06s ease, background 0.15s ease, border-color 0.15s ease;
    }
    #controls button:hover {
      background: rgba(30,30,30,0.85);
      border-color: rgba(255,215,0,0.55);
    }
    #controls button:active {
      transform: translateY(1px);
    }

    #canvas {
      width: min(92vmin, 820px);
      height: min(92vmin, 820px);
      border-radius: 50%;
      background: radial-gradient(circle at center, #111 0%, #000 62%);
      border: 1px solid rgba(255, 215, 0, 0.18);
      box-shadow:
        0 0 25px rgba(255, 215, 0, 0.16),
        0 0 80px rgba(140, 255, 205, 0.04),
        inset 0 0 35px rgba(255, 215, 0, 0.06);
    }

    #hud {
      width: 100%;
      display: flex;
      justify-content: space-between;
      gap: 10px;
      font-size: 11px;
      opacity: 0.82;
      padding: 8px 12px;
      border-radius: 14px;
      background: rgba(0,0,0,0.32);
      border: 1px solid rgba(255,215,0,0.16);
      box-shadow: inset 0 0 18px rgba(255,215,0,0.05);
    }

    #hud .pill {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      white-space: nowrap;
    }

    #legend {
      width: 100%;
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      justify-content: center;
      font-size: 11px;
      opacity: 0.82;
      padding-bottom: 4px;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,215,0,0.14);
      background: rgba(0,0,0,0.25);
    }
    .legend-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
    }

    /* Planet colors */
    .sun     { background: #ffd700; }
    .mercury { background: #c0c0c0; }
    .venus   { background: #ffbf7f; }
    .earth   { background: #4cc9f0; }
    .mars    { background: #ff6b6b; }
    .jupiter { background: #ffdd99; }
    .saturn  { background: #f4e285; }
    .uranus  { background: #7fffd4; }
    .neptune { background: #6c5ce7; }
    .pluto   { background: #b388ff; }

    /* UPDATED: veil + frame now attach to #frameCard (not viewport) */
    #nouveauVeil{
      position: absolute;
      inset: 0;
      z-index: 1;
      pointer-events: none;
      opacity: 0.14;
      border-radius: 26px;
      background:
        radial-gradient(circle at 12% 18%, rgba(140,255,205,0.20) 0 10px, transparent 11px),
        radial-gradient(circle at 18% 26%, rgba(255,210,185,0.16) 0 8px, transparent 9px),
        radial-gradient(circle at 86% 22%, rgba(185,210,255,0.16) 0 9px, transparent 10px),
        radial-gradient(circle at 78% 84%, rgba(140,255,205,0.16) 0 10px, transparent 11px),
        radial-gradient(circle at 22% 78%, rgba(255,210,185,0.14) 0 10px, transparent 11px);
      mix-blend-mode: screen;
    }

    #nouveauFrame {
      position: absolute;
      inset: 0;
      z-index: 2;
      pointer-events: none;
      opacity: 0.98;
      filter: drop-shadow(0 0 18px rgba(255,215,0,0.10));
    }

    @media (max-width: 560px){
      #hud { flex-direction: column; align-items: center; }
    }
  </style>
</head>

<body>
  <div id="wrapper">

    <div id="frameCard">
      <div id="nouveauVeil" aria-hidden="true"></div>

      <!-- Art Nouveau Frame (panel-sized SVG) -->
      <svg id="nouveauFrame" viewBox="0 0 1000 1000" preserveAspectRatio="none" aria-hidden="true">
        <defs>
          <linearGradient id="goldStroke" x1="0" y1="0" x2="1" y2="1">
            <stop offset="0" stop-color="rgba(255,215,0,0.30)"/>
            <stop offset="0.35" stop-color="rgba(255,215,0,0.95)"/>
            <stop offset="0.7" stop-color="rgba(255,245,170,0.60)"/>
            <stop offset="1" stop-color="rgba(255,215,0,0.85)"/>
          </linearGradient>

          <radialGradient id="leafGreen" cx="40%" cy="40%" r="70%">
            <stop offset="0" stop-color="rgba(140,255,205,0.28)"/>
            <stop offset="1" stop-color="rgba(140,255,205,0.06)"/>
          </radialGradient>
          <radialGradient id="petalBlush" cx="40%" cy="40%" r="75%">
            <stop offset="0" stop-color="rgba(255,210,185,0.22)"/>
            <stop offset="1" stop-color="rgba(255,210,185,0.05)"/>
          </radialGradient>
          <radialGradient id="petalSky" cx="40%" cy="40%" r="75%">
            <stop offset="0" stop-color="rgba(185,210,255,0.18)"/>
            <stop offset="1" stop-color="rgba(185,210,255,0.05)"/>
          </radialGradient>

          <filter id="softGlow" x="-20%" y="-20%" width="140%" height="140%">
            <feGaussianBlur stdDeviation="1.2" result="b"/>
            <feMerge>
              <feMergeNode in="b"/>
              <feMergeNode in="SourceGraphic"/>
            </feMerge>
          </filter>

          <!-- FIX: Define the reusable corner ornament ONCE -->
          <g id="cornerTL">
            <path d="M70,150 C105,120 130,95 165,70 C145,120 125,155 90,190 C75,175 65,165 70,150 Z"
                  fill="url(#leafGreen)" stroke="url(#goldStroke)" stroke-width="1.6"/>
            <path d="M95,105 C120,90 150,80 185,78 C155,105 130,135 105,165 C92,142 88,125 95,105 Z"
                  fill="url(#leafGreen)" stroke="url(#goldStroke)" stroke-width="1.4" opacity="0.9"/>

            <path d="M140,160 C165,145 190,120 200,95 C215,125 210,155 190,180 C172,175 155,170 140,160 Z"
                  fill="url(#petalBlush)" stroke="url(#goldStroke)" stroke-width="1.2" opacity="0.9"/>
            <path d="M155,140 C180,130 205,110 220,86 C232,116 228,150 210,170 C192,165 173,155 155,140 Z"
                  fill="url(#petalSky)" stroke="url(#goldStroke)" stroke-width="1.0" opacity="0.85"/>

            <path d="M70,240 C120,210 150,190 210,170
                     C260,152 300,120 330,80"
                  fill="none" stroke="url(#goldStroke)" stroke-width="2.2" stroke-linecap="round" opacity="0.85"/>
            <path d="M120,240 C95,255 85,275 98,290
                     C110,305 140,300 142,280
                     C144,260 120,255 112,270"
                  fill="none" stroke="url(#goldStroke)" stroke-width="1.6" opacity="0.75"/>
            <path d="M210,170 C190,205 200,230 230,240
                     C265,252 290,230 280,205
                     C270,180 238,180 236,205"
                  fill="none" stroke="url(#goldStroke)" stroke-width="1.4" opacity="0.65"/>

            <circle cx="205" cy="205" r="7" fill="rgba(255,215,0,0.22)" stroke="url(#goldStroke)" stroke-width="1.2"/>
            <circle cx="205" cy="205" r="2.2" fill="rgba(255,215,0,0.85)"/>
          </g>
        </defs>

        <rect x="22" y="22" width="956" height="956" rx="42" ry="42"
              fill="none" stroke="url(#goldStroke)" stroke-width="2" opacity="0.75"/>
        <rect x="48" y="48" width="904" height="904" rx="34" ry="34"
              fill="none" stroke="rgba(255,215,0,0.25)" stroke-width="1.5"/>

        <g opacity="0.95" filter="url(#softGlow)">
          <g transform="translate(0,0)">
            <use href="#cornerTL"/>
          </g>
          <g transform="translate(1000,0) scale(-1,1)">
            <use href="#cornerTL"/>
          </g>
          <g transform="translate(0,1000) scale(1,-1)">
            <use href="#cornerTL"/>
          </g>
          <g transform="translate(1000,1000) scale(-1,-1)">
            <use href="#cornerTL"/>
          </g>
        </g>

        <g opacity="0.75" filter="url(#softGlow)">
          <path d="M210,60
                   C260,88 290,88 340,60
                   C390,32 420,32 470,60
                   C520,88 550,88 600,60
                   C650,32 680,32 730,60
                   C780,88 810,88 860,60"
                fill="none" stroke="url(#goldStroke)" stroke-width="1.5" stroke-linecap="round"/>

          <path d="M210,940
                   C260,912 290,912 340,940
                   C390,968 420,968 470,940
                   C520,912 550,912 600,940
                   C650,968 680,968 730,940
                   C780,912 810,912 860,940"
                fill="none" stroke="url(#goldStroke)" stroke-width="1.5" stroke-linecap="round"/>

          <path d="M60,210
                   C88,260 88,290 60,340
                   C32,390 32,420 60,470
                   C88,520 88,550 60,600
                   C32,650 32,680 60,730
                   C88,780 88,810 60,860"
                fill="none" stroke="url(#goldStroke)" stroke-width="1.5" stroke-linecap="round"/>

          <path d="M940,210
                   C912,260 912,290 940,340
                   C968,390 968,420 940,470
                   C912,520 912,550 940,600
                   C968,650 968,680 940,730
                   C912,780 912,810 940,860"
                fill="none" stroke="url(#goldStroke)" stroke-width="1.5" stroke-linecap="round"/>
        </g>
      </svg>

      <div id="content">
        <div id="header">
          <h1>HELIOS · NOUVEAU ORRERY</h1>
          <div id="subtitle">Art Nouveau frame · Platonic-face clockwork · Real-time + historical</div>

          <div id="controls">
            <label>
              Date:
              <input type="date" id="datePicker" />
            </label>

            <label>
              Time flow:
              <select id="speedSelect">
                <option value="realtime">Real-time</option>
                <option value="hour">1 hour / sec</option>
                <option value="day">1 day / sec</option>
                <option value="month">1 month / sec</option>
                <option value="year">1 year / sec</option>
                <option value="century">1 century / sec</option>
              </select>
            </label>

            <button id="todayBtn">Today (Live)</button>

            <button id="zoomOut">−</button>
            <button id="zoomIn">+</button>
          </div>
        </div>

        <canvas id="canvas"></canvas>

        <div id="hud">
          <div class="pill"><span style="opacity:.75;">Sim date:</span> <span id="simDateText">—</span></div>
          <div class="pill"><span style="opacity:.75;">Zoom:</span> <span id="zoomText">1.00×</span></div>
          <div class="pill"><span style="opacity:.75;">Mode:</span> <span id="modeText">Live</span></div>
        </div>

        <div id="legend"></div>
      </div>
    </div>
  </div>

  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    const datePicker = document.getElementById('datePicker');
    const todayBtn = document.getElementById('todayBtn');
    const zoomInBtn = document.getElementById('zoomIn');
    const zoomOutBtn = document.getElementById('zoomOut');
    const speedSelect = document.getElementById('speedSelect');
